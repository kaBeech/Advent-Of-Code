let my_string = "#.#.###...#.#";;

let input_challenge = "...................................................................................................................................
........#..........#.#.....#......................#...#...#............#.#.....................#...##..#.........#...#.#...........
..............#...#.....#...##..........................#...............#..............#...#....#......#..#.#........#..#..........
...........#................................................................#..........#.....#.#......#........#...#...............
..#...#..#...........#....#...#...#....#.#...#.##........................#...#..#............#........#........#...................
....#...........#...........##.#.....#.....#...........#....................#.#.........#....#..................#...#..#....#......
.##..#.....#......#..#................#.#.##.................................#...............#........#..#..#...#............#.#...
...#.......##.#..........#.....#....##.......#.......................................................#.....##..#........#....#...#.
..#..........#....#........#..#.......#.......##..................#...............#.....#.......#.............#...#.....#..#.......
.............#......#.#..................#.#.......................##.#............#.........#...#.........#...............#..##...
....##..........#.................#............................##.....#.........#......#....#.............#..#.........#.........#.
......#....#.....#.......................#.#.....#.........#.........#..#............................#.........................#...
............#..#.............#..#....................................#............................#.#.#...................##.......
....#.....................#...#....#...##................#............##....................##.#............#.......#.......##.....
.....#....................#....#...........................................................#....#....#.....#.................#.....
..................................#.......#..................#........#.#...#...........#..#.............#..#.......#..##..........
...........#...........#..........#.......................##.......#...#...#..............................#.............#.....#....
..#.#..###...................................................#.#....##.........................#...................#..#....#.......
...........#..#....#........#..........................#.##....................................#.....#....##.......#.........#.....
..........#................#.#.......#............#.....#.#.....#......#...#................#...#..................#..........#....
......#...........#............#...#....##...........#.........#.........#..........................##.........#.......#...........
...#.#.............#..#........#.......................#..........#..............#.........#....#.........#...#.#..#.............#.
......#..#......#.#.#.................#..................................#...#....#.........#.#.#..............#.....#..#..#..#....
...#.......#.#..#..........#........#.#.........#.......#...#.....................#...........##..#.......#.......#................
...#...#.#..................#........#..............#...#....#.#.............#.......#...........................#......#..........
.....#......#.................................#.......#....#.........##.........................#...............#..........#...#...
..#......#..#........#.#........................#...#..#.#.....................#.#..#...........#.#............#...........#..##...
.#.....#.......#....#..........#.#............#..#.................#...........#..........................#...........#...#.#.#....
...................#........#.##............#..................#....##..#.#..............#............#......#..........#..........
....#........#...##............................#....#....#....#...............#.......................#...#........................
............#..................#.......#......#......#..............#.#..#.......#.................#...#....##...............#.....
..........#..........#..#.............##.#..........#..#................................................#................#.........
.....#..........#.......................#..........#..........................#......................#....................##.##.#..
..#............##......#.#............#...........................#..#............#........#.................#...........#.........
..............#...........#...........#........#........#.........#.........###.............#............#.#.......#...#..#........
...........#......................#......#............#..................#.......#.#.#.#..#..#.................................#...
.....#..#........................#..................#........................#..##.....#.#.....#.........................#.#.......
.........................................#........#.....#...........#.....#...#.....#...#.......#.........#.#......#...#........#..
....#....#...............................#.....#.......#.#...#....#......................#........##..............#.....#....#.....
.....#........#................#.....#...............#.............................#.........................#....#.#....#.#...#...
..............#..................##.....#..#.#.#...##...............................###............................#.#.##.#....#...
..##.........................#.......................................................#..........#...#.#.......#.......#....#.......
.##............#.#...........................#....#.....................##.......#..#.....##.....................#...#....#....#...
........#...................#........#...........#....#.....#......#..#.....#.........#.#.#.....#.....................##.......#...
.......................................#.#.................#..##........#.#........................................#..#...#..#.....
.........#....#............#...#...#......#...#.......#.....##....#......#..#..........#.#.......#........#........#........#..#...
...................................................#..........#.......#....#..............#..#...........#.........#..#..........#.
...........#...........#...#..#........#...#.................#....##......##..........##........#.....#...............#.......#....
...............................#..#............#.#..#.......#........#..##......#..#.................................#....##....#..
......#.....#.........#.....#.#.#..#..#..#......................#.#...#...#............#.##...#..............#.................#...
.#...................#...#......#..#.....#.....#........................##....#............#.......#.#........#....................
..........#...........................#..#..........#..#..............#...#..................#....#.........................#......
...#..#..............#..........#..#............#...........................#....................#.................................
........................#........#..##...............#.#......................##....##....#.........#..............................
......#...........#........#.................#............#............##.#............###....#................................#.#.
...#..............##.....................###.#.......#......#...#.#..........#.......#............##.##........##.#..........#..#..
......................#.#.#........#........#.#.#...#....#..........#.....#.....#.............#...###......#........#...........#..
.............#.#......###.....#.....##.....#.#...........#.#...................#..........#....##.........#....#................#..
....................#...#...#.....##.#..#.........#........#..............#.......#...#..#...#.....................................
..................#.......##.....#..........#................#.....#.#....#.........##.........##.......#.......#.#................
..................#.#...#....#............#......#..........#.##......#....#..............##........#..................#...........
.....................#.....#.#.........#......................#............#...........#..#...................#..#...#.............
.......#.....##.........#..#..............#.......................#................#..........#.#.......#..#..........#............
.............##..........#....#..........................#..###...#..#......###...##......##.#......#..#........#..................
.........#....#..#.....#....#...#.......#.....#.......................##..................##.#.....#.....................#.........
.................................................................S.................................................................
...........#...#....##..#..#................#.......#..#....#..#........#....................##.....#....#.................###.....
.........#...#..#....................#.......#....#...........#................................#................#.#..#.#...........
........................#.........#.#......#.#..............#.......##....................#.#..............#........#.#.#..........
...........#..#............#..##.....#...#..#..........#.......#.....#...............#..............#....#...........#...#.........
....................#..#...#.......#...#................#.........#....##.....#..##..........##.........#..#.#.##.###..............
................#..#...........................#..#........................................#...................#..#................
..#........................##.................#....................#.....#................#...........#.........#...#..............
.#.......................#..#...........##......#........................................#...............#.....................##..
.#...#..........#....#.....#.....#...#...#............#........................#.........#..#..................#...............##..
..................................#......#.......#.................................##..#..................#...#.............###....
.......#............#.......##..................#.#...............##....................#.........#...#....##...#.#................
...#...#..........##.#.........##.................#....#..................................#...#......##....#..............#........
.....#.....................##.......................#..#..................#..#.......#.....##..#.#....#.....##...............#.....
....#...............#.......#..........#.................#...............#..#........#.....#..............#......................#.
.#.#...#.....................................#.....#........#..........#..#..#....##.........#..............................#.#....
................................#...................#................#.#..........#.......#.....#...........................#..#.#.
.........................................#.#.#..........#...........#..............#.............#...........#...............#.....
.......#.............................#..#...#.......#.#..#.............#...#..................#........#...........................
..#...#.......................#...........#............#..............#.#............#.#..##.##.......................#..#.........
..........#...#...........##.........#.......##.............................#............#.........#....#.#..........#.........#...
............#.............................#................#..#....#....#.#.....#..........#.....#..#................#...........#.
...........#...................#.............................#.............#............................#....................#.....
................#.....................#.#...#..#.#.#...#....................#............#..##...................#...#........#..#.
....................#...............#..#.......#....#.........#...........#...#........#.........................#........#..##....
..#............##....#.......#..........#....#........#........#................................#.........................#..#.....
........#..........#.##............#.#....#.............#...........#.....#......#.......##.....#............#.#....#............#.
...#..................#..............#...........#.#...#...................#...#...................#..........##..#................
.........#.#.........#....................#..........#..........#..#.#.......................#.#..............#..................#.
........#..##...#.#.#...............#.......#..........................#.............#...................#.............##......#...
............#..#..#.....#...........#................................#....##......#............#.........#..........##..........#..
............#.......#....#.............##.#.......#...#.........................#...........#..............#...##................#.
....#.##.....#...#.........................#...#......#.#.#............#........#....................................#.............
..#.........#...................................#......#.............................#........................#....................
......##...#...........#................#..#..............#..##...............#.#......#.........................#....##...........
...#......#............................#..#.....#............##...........###..#....#..............#......................#........
.#...............#...................................#.......................#.......................#.............#...##.....#....
...........#........#.##...#...............##...#...........................#.....#......#.............................#..#......#.
..#..............#.....#.#.................#...#..........#........#..............................##.....#......#...#......#.....#.
.#.......................#...................#.#....##.....#...................................#....#.......................#......
..........#...........#.#........#.#.........#.......#.........#.............#........#.........#.#......#..............#...#....#.
..#...#.#........#......................................#..........#.#............................................#.......#........
.............#....#..............##.#..................#......#............#....#...............#..........#.......#.#....#...#....
...#.......#.......##.....#...#....#....................#.............#..#..........................#......................#.....#.
...#.......#.........#..#...............#.......................#.#..##.#.#...#...............#.#.#...........#..........#.........
.#....................#...#........#.............##......................##................#........#..................#.#..#......
..............#.#....................###.................#.....#..........##................#......##.#.#....#..........#..........
...........#...........#.......#...........#..........................#.....................#.......#.#.....#..........#.........#.
...........#..#..#...#.....................................#.#.............#.............#....#..##.........#..#....#.....#........
........##..#..#..............................................##......#....#..........#...................##..#.#...............#..
.....##..#..#.....#...............#.#.#..#................#...#.....#...#...#.........#.#....#..........#.................#........
..................#.#..............#........................##..#.......#.##......................#.........#.#.........#...#......
.#..#...................#.......................#.....................#.......................#...##...#.#....#...#......#.........
....#......#...#...........#..#...........#....#........................#............#.................................#...........
...#...............#..........#..........#....................##....#..#..............#.............#.....#....##....#.............
...##....#.##.....#..............#..#....#...............................................##........#....#.......#.......#......#...
.....................#....#.....#.....#..........#.............#................................#........##.........#..............
..........#..#.....#....#...............#......#..................#..............#........#...#.#........#.#.............#..#......
......#.........#.##........#..................#..............#...............#..##...#......#....#...#...#............#......#....
.#...........................................#.......#.............#......................##......#.....#..#.......................
.................#....##.......#.................#................................#......#.....#..#.........#...........##....#....
.#................................#...#......#....#...#............................#............#.....##...........................
....#....#.#.......#.......#.#.....#.........#.........#.................#...........#.....#...........#..#.......#................
.....................................#.....#....#...........................#..#.#..........#.#........#........#......#.....#.....
.#...#..........#..#.................#.............#.........................................................................##....
..................................................................................................................................."

let count_dots str =
  let rec count_dots' str i =
    if i = String.length str then 0
    else if str.[i] = '.' then 1 + count_dots' str (i + 1)
    else count_dots' str (i + 1)
  in
  count_dots' str 0;;

let dots_proto = count_dots my_string;;
let dots_challenge = count_dots input_challenge;;

let solve_part_1 str x y =
  let rec solve_part_1' str x y i acc =
    if i = String.length str then acc
    else if str.[i] = '\n' then solve_part_1' str (-64) (y - 1) (i + 1) acc
    else if str.[i] = '.' && (abs x + abs y < 64) then solve_part_1' str (x + 1) y (i + 1) (acc + 1)
    else solve_part_1' str (x + 1) y (i + 1) acc
  in
  solve_part_1' str x y 0 0;;

let solution_part_1 = solve_part_1 input_challenge (-64) 64;;

(* Print *)

print_endline "hello";
  print_endline "world";
  print_endline my_string;
  print_endline (string_of_int dots_proto);
  print_endline (string_of_int dots_challenge);
  print_endline (string_of_int solution_part_1);;
